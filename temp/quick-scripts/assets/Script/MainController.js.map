{"version":3,"sources":["MainController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["const {ccclass, property} = cc._decorator;\r\nimport Pipe from './Pipe'\r\n\r\n@ccclass\r\nexport default class Main extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    birdParent: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    background: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    allpipe: cc.Node = null;\r\n\r\n    @property(cc.Prefab)\r\n    fabPipe: cc.Prefab = null;\r\n\r\n    @property(cc.Label)\r\n    scoreLb: cc.Label = null;\r\n\r\n    @property(cc.Node)\r\n    nodeGameover: cc.Node = null;\r\n\r\n    @property(cc.Button)\r\n    retryBtn: cc.Button = null;\r\n\r\n    @property([cc.Sprite])\r\n    birds: cc.Sprite[] = [];\r\n\r\n    @property\r\n    time: number = 0;\r\n    pipeArr: any[] = [1,2,3];\r\n    speed: number = 0;\r\n    over: boolean = false;\r\n    gamestart: boolean = false;\r\n    score: number = 0;\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        console.log('----load');\r\n    }\r\n\r\n    start () {\r\n        let pipeStartX: number = 200;\r\n        let spaceX = (288 + 52) / 3;\r\n        this.pipeArr = this.pipeArr.map((v, i) => {\r\n            let instance = cc.instantiate(this.fabPipe).getComponent(Pipe);\r\n            instance.node.parent = this.allpipe;\r\n            instance.node.x = pipeStartX + spaceX * i;\r\n            return instance;\r\n        });\r\n\r\n        this.birds.forEach((v,i) => {\r\n            if(i !== 0){\r\n                v.node.active = false;\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    touch () {\r\n        if(this.over){\r\n            return;\r\n        }\r\n        this.speed = 2.6;\r\n    }\r\n\r\n    update (dt: number) {\r\n        this.time += dt;\r\n\r\n        if(this.time > 0.2){\r\n            for(let i = 0; i < this.birds.length; i++){\r\n                let v = this.birds[i];\r\n                if(v.node.active){\r\n                    v.node.active = false;\r\n    \r\n                    if(i === 3){\r\n                        this.birds[0].node.active = true;\r\n                    }else{\r\n                        this.birds[i + 1].node.active = true;\r\n                    }\r\n\r\n                    break;\r\n                }\r\n            }\r\n\r\n            this.time = 0;\r\n        }\r\n\r\n        if(!this.gamestart){\r\n            return;\r\n        }\r\n\r\n        this.speed -= 0.1;\r\n        this.birdParent.y += this.speed;\r\n\r\n        if(this.over){\r\n            this.birdParent.rotation += 10;\r\n            return;\r\n        }\r\n\r\n        this.background.x -= 1;\r\n        if(this.background.x == -288){\r\n            this.background.x = 0;\r\n        }\r\n\r\n        this.pipeArr.forEach((v, i) => {\r\n            if(v.node.x < -26){\r\n                console.log('===========', v.counted);\r\n                if(!v.counted){\r\n                    this.score += 1;\r\n                    v.counted = true;\r\n                    this.scoreLb.string = this.score + '';\r\n                }\r\n            }\r\n            v.move();\r\n            this.over = v.check(this.birdParent) || this.over;\r\n        });\r\n\r\n        if(this.over){\r\n            this.gameOver();\r\n        }\r\n    }\r\n\r\n    handleStart(){\r\n        this.gamestart = true;\r\n        this.over = false;\r\n        this.nodeGameover.active = false;\r\n        this.retryBtn.node.active = false;\r\n        this.reset();\r\n    }\r\n\r\n    gameOver(){\r\n        this.nodeGameover.active = true;\r\n        this.retryBtn.node.active = true;\r\n    }\r\n\r\n    reset(){\r\n        this.time = 0;\r\n        this.pipeArr.forEach((v, i) => {\r\n            v.reset(i)\r\n        });\r\n        this.speed = 0;\r\n        this.score = 0;\r\n        this.birdParent.x = 0;\r\n        this.birdParent.y = 0;\r\n        this.birdParent.rotation = 0;\r\n    }\r\n}\r\n"]}